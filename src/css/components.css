/**
 * 通用组件样式
 */

/* ==================== 按钮 ==================== */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 14px;
  font-weight: 500;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-fast);
  text-decoration: none;
  white-space: nowrap;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--primary);
  color: var(--text-inverse);
}

.btn-primary:hover:not(:disabled) {
  background: var(--primary-hover);
}

.btn-primary:active:not(:disabled) {
  background: var(--primary-active);
}

.btn-secondary {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.btn-secondary:hover:not(:disabled) {
  background: var(--border-color);
}

.btn-outline {
  background: transparent;
  color: var(--primary);
  border: 1px solid var(--primary);
}

.btn-outline:hover:not(:disabled) {
  background: var(--primary-light);
}

.btn-danger {
  background: var(--danger);
  color: var(--text-inverse);
}

.btn-danger:hover:not(:disabled) {
  background: #b52b2f;
}

.btn-ghost {
  background: transparent;
  color: var(--text-secondary);
}

.btn-ghost:hover:not(:disabled) {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.btn-sm {
  padding: var(--spacing-xs) var(--spacing-sm);
  font-size: 12px;
}

.btn-lg {
  padding: var(--spacing-md) var(--spacing-lg);
  font-size: 16px;
}

.btn-icon {
  width: 36px;
  height: 36px;
  padding: 0;
}

.btn-icon.btn-sm {
  width: 28px;
  height: 28px;
}

/* ==================== 输入框 ==================== */
.input {
  width: 100%;
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 14px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--bg-primary);
  color: var(--text-primary);
  transition: all var(--transition-fast);
}

.input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px var(--primary-light);
}

.input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.input-group {
  display: flex;
  gap: var(--spacing-sm);
}

.input-group .input {
  flex: 1;
}

/* ==================== 选择框 ==================== */
.select {
  width: 100%;
  padding: 8px 32px 8px 16px;
  font-size: 15px;
  border: 1px solid transparent; /* Remove visible border */
  border-radius: var(--radius-full); /* Capsule shape */
  background-color: var(--bg-secondary); /* Subtle background */
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s ease;
  appearance: none; /* Remove default arrow */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  font-weight: 500;
}

.select:hover {
  background-color: var(--bg-tertiary);
}

.select:focus {
  outline: none;
  background-color: var(--bg-primary);
  border-color: var(--primary);
  box-shadow: 0 0 0 3px var(--primary-light);
}

/* ==================== 自定义下拉框 (Custom Select) ==================== */
.custom-select-wrapper {
  position: relative;
  user-select: none;
  width: 100%;
}

.custom-select {
  position: relative;
  display: flex;
  flex-direction: column;
}

.custom-select-trigger {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px; /* Slightly larger feeling */
  font-size: 15px;
  font-weight: 500;
  color: var(--text-primary);
  background: var(--bg-secondary);
  border: 1px solid transparent;
  border-radius: var(--radius-full); /* Capsule */
  cursor: pointer;
  transition: all 0.2s;
}

.custom-select-trigger:hover {
  background: var(--bg-tertiary);
}

.custom-select.open .custom-select-trigger {
  background: var(--bg-primary);
  border-color: var(--primary);
  box-shadow: 0 0 0 3px var(--primary-light);
  border-radius: var(--radius-full); /* Keep capsule, menu floats */
}

/* Arrow */
.custom-select-trigger::after {
  content: '';
  width: 16px;
  height: 16px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
  transition: transform 0.3s;
}

.custom-select.open .custom-select-trigger::after {
  transform: rotate(180deg);
}

.custom-options {
  position: absolute;
  top: calc(100% + 8px);
  left: 0;
  right: 0;
  background: var(--bg-card); /* Stronger bg */
  border: 1px solid var(--border-color);
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  z-index: 100;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  max-height: 300px;
  overflow-y: auto;
  padding: 6px;
}

.custom-select.open .custom-options {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.custom-option {
  padding: 10px 16px;
  font-size: 14px;
  color: var(--text-primary);
  cursor: pointer;
  border-radius: 8px; /* Inner radius */
  transition: all 0.1s;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.custom-option:hover {
  background: var(--bg-hover);
  color: var(--primary);
}

.custom-option.selected {
  background: var(--primary-light);
  color: var(--primary);
  font-weight: 600;
}

/* Checkmark for selected */
.custom-option.selected::after {
  content: '✓';
  font-weight: bold;
}

/* ==================== 复选框和开关 ==================== */
.checkbox {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  cursor: pointer;
}

.checkbox input {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.switch {
  position: relative;
  width: 44px;
  height: 24px;
  background: var(--border-color);
  border-radius: var(--radius-full);
  cursor: pointer;
  transition: background var(--transition-fast);
}

.switch::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: 50%;
  transition: transform var(--transition-fast);
}

.switch.active {
  background: var(--primary);
}

.switch.active::after {
  transform: translateX(20px);
}

/* ==================== 卡片 ==================== */
.card {
  background: var(--bg-card);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-card);
  overflow: hidden;
}

.card-header {
  padding: var(--spacing-md) var(--spacing-lg);
  border-bottom: 1px solid var(--border-light);
  font-weight: 600;
}

.card-body {
  padding: var(--spacing-lg);
}

.card-footer {
  padding: var(--spacing-md) var(--spacing-lg);
  border-top: 1px solid var(--border-light);
  background: var(--bg-secondary);
}

/* ==================== 表格 ==================== */
.table {
  width: 100%;
  border-collapse: collapse;
}

.table th,
.table td {
  padding: var(--spacing-sm) var(--spacing-md);
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.table th {
  font-weight: 600;
  background: var(--bg-secondary);
  color: var(--text-secondary);
  font-size: 12px;
  text-transform: uppercase;
}

.table tr:hover {
  background: var(--bg-secondary);
}

.table-actions {
  display: flex;
  gap: var(--spacing-xs);
}

/* ==================== 模态框 ==================== */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg-overlay);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-fast);
}

.modal-overlay.active {
  opacity: 1;
  visibility: visible;
}

.modal {
  background: var(--bg-modal);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  min-width: 400px;
  max-width: 90%;
  max-height: 90%;
  display: flex;
  flex-direction: column;
  transform: scale(0.9);
  transition: transform var(--transition-fast);
}

.modal-overlay.active .modal {
  transform: scale(1);
}

.modal-header {
  padding: var(--spacing-lg);
  border-bottom: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.modal-title {
  font-size: 18px;
  font-weight: 600;
}

.modal-close {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: var(--radius-md);
  font-size: 20px;
}

.modal-close:hover {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.modal-body {
  padding: var(--spacing-lg);
  overflow-y: auto;
  flex: 1;
}

.modal-footer {
  padding: var(--spacing-md) var(--spacing-lg);
  border-top: 1px solid var(--border-light);
  display: flex;
  justify-content: flex-end;
  gap: var(--spacing-sm);
}

/* ==================== 表单 ==================== */
.form-group {
  margin-bottom: var(--spacing-md);
}

.form-label {
  display: block;
  margin-bottom: var(--spacing-xs);
  font-weight: 500;
  color: var(--text-secondary);
}

.form-hint {
  margin-top: var(--spacing-xs);
  font-size: 12px;
  color: var(--text-tertiary);
}

.form-row {
  display: flex;
  gap: var(--spacing-md);
}

.form-row .form-group {
  flex: 1;
}

/* ==================== 头像/照片 ==================== */
.avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  font-size: 16px;
  color: var(--text-secondary);
}

.avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.avatar-lg {
  width: 80px;
  height: 80px;
  font-size: 32px;
}

.avatar-xl {
  width: 120px;
  height: 120px;
  font-size: 48px;
}

/* ==================== 标签 ==================== */
.badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  font-size: 12px;
  font-weight: 500;
  border-radius: var(--radius-full);
  background: var(--bg-tertiary);
  color: var(--text-secondary);
}

.badge-primary {
  background: var(--primary-light);
  color: var(--primary);
}

.badge-success {
  background: #e6f4e6;
  color: var(--success);
}

.badge-warning {
  background: #fff4e5;
  color: var(--warning);
}

.badge-danger {
  background: #fde7e8;
  color: var(--danger);
}

/* ==================== 空状态 ==================== */
.empty-state {
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--text-tertiary);
  box-shadow: none !important;
  background: transparent !important;
  border: none !important;
}

.empty-state-icon {
  font-size: 64px;
  margin-bottom: var(--spacing-md);
  opacity: 0.5;
  display: inline-block;
}

.empty-state-title {
  font-size: 16px;
  margin-bottom: var(--spacing-sm);
  color: var(--text-secondary);
}

.empty-state-desc {
  font-size: 14px;
}

/* ==================== 分割线 ==================== */
.divider {
  height: 1px;
  background: var(--border-light);
  margin: var(--spacing-md) 0;
}

/* ==================== 设置项 ==================== */
.setting-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-md) 0;
  border-bottom: 1px solid var(--border-light);
}

.setting-item:last-child {
  border-bottom: none;
}

.setting-label {
  font-weight: 500;
}

.setting-desc {
  font-size: 12px;
  color: var(--text-tertiary);
  margin-top: 2px;
}

.setting-section {
  margin-bottom: var(--spacing-lg);
}

.setting-section-title {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--text-tertiary);
  margin-bottom: var(--spacing-sm);
}

/* ==================== 主题选择网格 ==================== */
.theme-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-sm);
}

.theme-option {
  padding: var(--spacing-md);
  border: 2px solid var(--border-color);
  border-radius: var(--radius-md);
  text-align: center;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.theme-option:hover {
  border-color: var(--primary);
}

.theme-option.active {
  border-color: var(--primary);
  background: var(--primary-light);
}

.theme-option-name {
  font-size: 12px;
  margin-top: var(--spacing-xs);
}

/* ==================== 抽取结果 ==================== */
.pick-result {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: var(--spacing-lg);
  padding: var(--spacing-xl);
}

.pick-result-item {
  text-align: center;
}

.pick-result-item .avatar {
  margin: 0 auto var(--spacing-sm);
}

.pick-result-name {
  font-size: 18px;
  font-weight: 600;
}

.pick-result-id {
  font-size: 14px;
  color: var(--text-secondary);
}

/* ==================== 动作栏 ==================== */
.action-bar {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin-bottom: var(--spacing-lg);
}

.action-bar-left {
  display: flex;
  gap: var(--spacing-sm);
}

.action-bar-right {
  margin-left: auto;
  display: flex;
  gap: var(--spacing-sm);
}

/* ==================== 计数器 ==================== */
.counter {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.counter-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--bg-primary);
  color: var(--text-primary);
  cursor: pointer;
  font-size: 18px;
}

.counter-btn:hover {
  background: var(--bg-tertiary);
}

.counter-value {
  min-width: 40px;
  text-align: center;
  font-size: 18px;
  font-weight: 600;
}

/* 结果页关闭按钮 */
.icon-btn-close {
  position: absolute;
  top: 32px;
  right: 32px;
  background: var(--bg-secondary); /* Use theme variable */
  border: 1px solid var(--border-color);
  color: var(--text-primary); /* Use theme variable */
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 10;
}

.icon-btn-close:hover {
  background: var(--bg-tertiary);
  transform: rotate(90deg);
}

.icon-btn-close:active {
  transform: scale(0.9);
}

/* ==================== 聚光灯舞台 (Spotlight Stage) ==================== */
.spotlight-stage {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  position: relative;
  overflow: hidden;
  padding: var(--spacing-md);
}

.stage-center {
  position: relative;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 60px; /* Leave space for controls text */
}

/* 装饰性光环 */
.glow-ring {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 300px;
  height: 300px;
  border-radius: 50%;
  background: radial-gradient(circle, var(--primary-light) 0%, transparent 70%);
  opacity: 0.1;
  filter: blur(20px);
  z-index: -1;
  animation: breathe 4s ease-in-out infinite alternate;
}

@keyframes breathe {
  0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.1; }
  100% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.2; }
}

/* 现代抽取按钮 - Premium Design */
.pick-button-modern {
  width: 220px;
  height: 220px;
  border-radius: 50%;
  background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-secondary) 100%);
  border: none;
  color: var(--text-primary);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  position: relative;
  z-index: 2;
  overflow: hidden;
}

/* 渐变边框 */
.pick-button-modern::before {
  content: '';
  position: absolute;
  inset: -3px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark), var(--primary));
  z-index: -1;
  opacity: 0.8;
  transition: opacity 0.3s, transform 0.5s;
}

/* 内部白色圆 */
.pick-button-modern::after {
  content: '';
  position: absolute;
  inset: 3px;
  border-radius: 50%;
  background: linear-gradient(145deg, var(--bg-card), var(--bg-secondary));
  z-index: -1;
}

/* 光晕动画 */
.glow-ring {
  position: absolute;
  width: 260px;
  height: 260px;
  border-radius: 50%;
  border: 2px solid var(--primary);
  opacity: 0.3;
  animation: glowPulse 2s ease-in-out infinite;
  pointer-events: none;
}

@keyframes glowPulse {
  0%, 100% { 
    transform: scale(1); 
    opacity: 0.3;
    border-color: var(--primary);
  }
  50% { 
    transform: scale(1.1); 
    opacity: 0.1;
    border-color: var(--primary-light);
  }
}

.pick-button-modern .btn-text {
  font-size: 36px;
  font-weight: 900;
  letter-spacing: 3px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 50%, var(--primary) 100%);
  background-size: 200% auto;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  text-transform: uppercase;
  animation: shimmer 3s linear infinite;
}

@keyframes shimmer {
  0% { background-position: 0% center; }
  100% { background-position: 200% center; }
}

.pick-button-modern .btn-subtext {
  font-size: 11px;
  text-transform: uppercase;
  color: var(--text-tertiary);
  margin-top: 6px;
  font-weight: 600;
  letter-spacing: 2px;
  opacity: 0.7;
}

.pick-button-modern:hover {
  transform: translateY(-8px) scale(1.05);
}

.pick-button-modern:hover::before {
  opacity: 1;
  animation: borderRotate 3s linear infinite;
}

@keyframes borderRotate {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.pick-button-modern:hover .glow-ring {
  animation: glowPulseActive 1s ease-in-out infinite;
}

@keyframes glowPulseActive {
  0%, 100% { 
    transform: scale(1); 
    opacity: 0.5;
  }
  50% { 
    transform: scale(1.15); 
    opacity: 0.2;
  }
}

.pick-button-modern:active {
  transform: translateY(2px) scale(0.98);
}

.pick-button-modern.picking {
  animation: spinButton 0.8s infinite linear;
}

.pick-button-modern.picking::before {
  animation: borderRotate 0.5s linear infinite;
  opacity: 1;
}

.pick-button-modern.picking .glow-ring {
  animation: glowPulsePicking 0.5s ease-in-out infinite;
}

@keyframes spinButton {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

@keyframes glowPulsePicking {
  0%, 100% { transform: scale(1); opacity: 0.8; }
  50% { transform: scale(1.2); opacity: 0.3; }
}

/* 底部控制栏 */
.stage-controls {
  position: absolute;
  bottom: 40px;
  display: flex;
  justify-content: center;
  width: 100%;
}

/* 胶囊计数器 */
.counter-pill {
  display: flex;
  align-items: center;
  background: var(--bg-card);
  padding: 4px;
  border-radius: 99px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08); /* Soft shadow */
  border: 1px solid var(--border-color);
  gap: 8px;
}

.pill-btn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: var(--bg-secondary);
  color: var(--text-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.pill-btn:hover {
  background: var(--primary-light);
  color: var(--primary);
  transform: scale(1.1);
}

.pill-btn:active {
  transform: scale(0.9);
}

.pill-display {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 60px;
}

.pill-label {
  font-size: 9px;
  text-transform: uppercase;
  color: var(--text-tertiary);
  letter-spacing: 0.5px;
  margin-top: 2px;
}

.pill-value {
  font-size: 18px;
  font-weight: 700;
  line-height: 1;
  color: var(--text-primary);
}

/* ==================== 结果遮罩层 (Result Overlay) ==================== */
.pick-result-overlay {
  position: fixed; /* Changed from absolute to fixed */
  top: 0;
  left: 0;
  width: 100vw; /* cover viewport width */
  height: 100vh; /* cover viewport height */
  background: rgba(var(--bg-primary-rgb), 0.95);
  backdrop-filter: blur(10px);
  z-index: 2500; /* Ensure it's on top of everything including sidebar (usually z-index 100-1000) */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-out;
}

.result-content {
  display: flex;
  flex-wrap: wrap; /* Allow wrapping for better centering */
  justify-content: center; /* Center items */
  align-items: center;
  gap: 32px;
  max-width: 90vw;
  max-height: 80vh;
  overflow-y: auto; /* Scroll vertical if too many */
  padding: 40px;
}

/* Remove the pseudo centering trick as we use wrap+center */
/* .result-content::before, .result-content::after { content: none; } */

/* Optional: hide scrollbar but keep functionality */
.result-content::-webkit-scrollbar {
  height: 8px; /* Show a small horizontal scrollbar */
}
.result-content::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}
.result-content::-webkit-scrollbar-track {
  background: transparent;
}



.pick-result-item .avatar {
  width: 120px;
  height: 120px;
  font-size: 48px;
  border: 4px solid var(--bg-card);
  box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  margin-bottom: 16px;
  background: var(--bg-card);
}

.pick-result-name {
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary); /* Remove transparent gradient to ensure visibility */
  margin-top: var(--spacing-sm);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.pick-result-id {
  font-size: 14px;
  color: var(--text-tertiary);
  margin-top: 4px;
  background: var(--bg-tertiary);
  padding: 2px 8px;
  border-radius: 12px;
}

/* 积分控制器 */
.score-controls {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 12px;
}

.btn-score {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 2px solid var(--border-color);
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 20px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-score:hover {
  transform: scale(1.1);
}

.btn-score-plus {
  border-color: var(--success);
  color: var(--success);
}

.btn-score-plus:hover {
  background: var(--success);
  color: white;
}

.btn-score-minus {
  border-color: var(--danger);
  color: var(--danger);
}

.btn-score-minus:hover {
  background: var(--danger);
  color: white;
}

.score-display {
  min-width: 48px;
  text-align: center;
  font-size: 24px;
  font-weight: 700;
  color: var(--primary);
  padding: 4px 12px;
  background: var(--bg-tertiary);
  border-radius: 8px;
}

.score-flash {
  animation: scoreFlash 0.3s;
}

@keyframes scoreFlash {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); background: var(--primary-light); }
  100% { transform: scale(1); }
}

/* 结果页关闭按钮 */
.icon-btn-close {
  position: absolute;
  top: 32px;
  right: 32px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  color: var(--text-primary);
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 10;
}

.icon-btn-close:hover {
  background: var(--bg-tertiary);
  transform: rotate(90deg);
}

.icon-btn-close:active {
  transform: scale(0.9);
}

/* ... (omitting intermediate styles if contiguous, but we are jumping to end of file usually) ... */
/* Actually, let's just replace the blocks we need. */

/* 结果操作按钮容器 */
.result-actions {
  display: flex;
  gap: 20px;
  margin-top: 20px;
  animation: slideUp 0.4s 0.2s backwards;
  z-index: 20;
}

.btn-result-secondary {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  border-radius: 99px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-result-secondary:hover {
  background: var(--bg-tertiary);
  transform: translateY(-2px);
}

.btn-result-secondary:active {
  transform: translateY(0);
}

/* 再次重试按钮 */
.retry-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 99px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 8px 20px rgba(var(--primary-rgb), 0.4);
  transition: all 0.3s;
}

.retry-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(var(--primary-rgb), 0.5);
}

.retry-btn:active {
  transform: translateY(0);
}

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes resultPop { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
@keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* ==================== 滚动动画遮罩 (Rolling Mask) ==================== */
.rolling-mask {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 3000;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 1;
}

.rolling-container {
  display: flex;
  flex-direction: row;
  gap: 0; /* Remove gap to merge conceptually, or keep small gap for readability? Let's use small gap but inside one box. Or spread out? */
  /* User: "Change to single screen". A unified container border looks like "one screen". */
  gap: 20px; 
  padding: 40px;
  background: var(--bg-card); /* Container has background now */
  border: 2px solid var(--primary-color);
  border-radius: 20px;
  align-items: center;
  justify-content: center;
  flex-wrap: nowrap; /* Force single row usually */
  max-width: 95vw;
}

.rolling-slot {
  width: 200px;
  height: 320px;
  background: transparent; /* Transparent slot */
  /* Remove border/radius/shadow from slot */
  position: relative;
  overflow: hidden;
  /* Keep mask for fade effect on columns */
  -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 80%, transparent 100%);
  mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 80%, transparent 100%);
}

/* Highlight line - Apply to container or individual slots?
   If individual slots, user sees multiple "focuses".
   If I want "one screen", maybe one highlight line across all?
   Let's keep individual highlight lines but make them subtle or remove provided I ensure correct focus style.
   User wants "slot machine", so line is good.
   I will keep it but remove box-shadow.
*/
.rolling-slot::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  width: 100%;
  height: 64px;
  transform: translateY(-50%);
  /* Remove borders to be cleaner? Or keep simple line? */
  border-top: 1px solid rgba(var(--text-primary-rgb), 0.1);
  border-bottom: 1px solid rgba(var(--text-primary-rgb), 0.1);
  pointer-events: none;
  z-index: 10;
}

.rolling-track {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  will-change: transform;
}

.rolling-item {
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 600;
  color: var(--text-secondary); /* Default darker */
  width: 100%;
  white-space: nowrap;
  padding: 0 10px;
  transform-origin: center center;
}

.rolling-text {
  display: none; 
}

/* ==================== 照片上传 ==================== */
.photo-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-sm);
}

.photo-preview {
  width: 100px;
  height: 100px;
  border-radius: var(--radius-md);
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border: 2px dashed var(--border-color);
}

.photo-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.photo-preview.has-photo {
  border-style: solid;
}

/* ==================== Toast 消息 ==================== */
.toast-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.toast {
  padding: var(--spacing-md) var(--spacing-lg);
  background: var(--bg-card);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  animation: slideIn 0.3s ease;
}

.toast-success { border-left: 4px solid var(--success); }
.toast-error { border-left: 4px solid var(--danger); }
.toast-warning { border-left: 4px solid var(--warning); }
.toast-info { border-left: 4px solid var(--info); }

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

/* ==================== 强调色选择 ==================== */
.color-grid {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
}

.accent-option {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  border: 4px solid transparent; /* Border for spacing */
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  display: flex;
  align-items: center;
  justify-content: center;
}

.accent-option:hover {
  transform: scale(1.1);
}

.accent-option.active {
  transform: scale(1.1);
  border-color: var(--bg-card); /* Inner white border */
  box-shadow: 0 0 0 2px var(--primary); /* Outer ring using current primary or self color? Usually self. */
}

/* We will assign background color inline in JS, or use classes. 
   Since colors are dynamic in JS map, inline style is better.
   For active state ring, we need it to match the option color.
   So we might use boxShadow in inline style or use a specific class.
   Actually, `box-shadow` with `currentcolor`?
   Let's just use a generic active ring (grey or primary) or rely on JS to set active style.
   Standard "ring" approach:
   box-shadow: 0 0 0 2px var(--bg-card), 0 0 0 4px [color];
*/
.accent-option.active {
  box-shadow: 0 0 0 2px var(--bg-card), 0 0 0 4px var(--text-primary); /* Use text color for ring contrast? Or just let JS handle specifics */
}
/* Let's wait for JS implementation to invoke styles. */

/* ==================== 空状态卡片 ==================== */
.empty-state-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: var(--spacing-xl);
  background: var(--bg-card);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  max-width: 400px;
  animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.empty-state-icon-wrapper {
  width: 120px;
  height: 120px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-light), var(--bg-tertiary));
  border-radius: 50%;
  margin-bottom: var(--spacing-lg);
  color: var(--primary);
}

.empty-state-card .empty-state-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: var(--spacing-sm);
}

.empty-state-desc {
  font-size: 1rem;
  color: var(--text-tertiary);
  margin-bottom: var(--spacing-lg);
  line-height: 1.5;
}

.empty-state-card .btn {
  min-width: 160px;
}

/* ==================== 抽取动画样式 ==================== */

/* 动画遮罩层 */
.animation-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: overlayFadeIn 0.3s ease-out;
}

@keyframes overlayFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* 滚动动画 */
.scroll-animation-box {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
  background: var(--bg-card);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
  min-width: 300px;
}

.scroll-names {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.scroll-name {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--text-primary);
  text-align: center;
  animation: scrollPulse 0.1s ease-out;
}

.scroll-name.final {
  color: var(--primary);
  animation: finalReveal 0.5s ease-out;
}

@keyframes scrollPulse {
  0% { transform: scale(1.1); opacity: 0.8; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes finalReveal {
  0% { transform: scale(1.5); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

/* 转盘动画 */
.wheel-animation-box {
  position: relative;
  width: 320px;
  height: 320px;
}

.wheel-pointer {
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 2rem;
  color: var(--primary);
  z-index: 10;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
}

.wheel {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: conic-gradient(
    from 0deg,
    var(--primary-light) 0deg 30deg,
    var(--bg-card) 30deg 60deg,
    var(--primary-light) 60deg 90deg,
    var(--bg-card) 90deg 120deg,
    var(--primary-light) 120deg 150deg,
    var(--bg-card) 150deg 180deg,
    var(--primary-light) 180deg 210deg,
    var(--bg-card) 210deg 240deg,
    var(--primary-light) 240deg 270deg,
    var(--bg-card) 270deg 300deg,
    var(--primary-light) 300deg 330deg,
    var(--bg-card) 330deg 360deg
  );
  border: 4px solid var(--primary);
  box-shadow: var(--shadow-xl);
  position: relative;
  transition: transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99); /* 确保 transition 被设置 */
}

.wheel-slice {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  transform-origin: center center;
}

.wheel-slice span {
  position: absolute;
  top: 20px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  max-width: 80px;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* 卡片翻转动画 (修复版) */
.flip-animation-box {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  justify-content: center;
  max-width: 600px;
}

.flip-card {
  width: 120px;
  height: 160px;
  perspective: 1000px; /* 父容器透视 */
  background-color: transparent;
}

.flip-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  text-align: center;
  transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  transform-style: preserve-3d; /* 关键：保留 3D 空间 */
  transform-origin: center center;
}

/* 翻转状态 */
.flip-card.flipped .flip-card-inner {
  transform: rotateY(180deg);
}

.flip-card-front,
.flip-card-back {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-backface-visibility: hidden; /* 关键：隐藏背面 */
  backface-visibility: hidden;
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  font-weight: 700;
  box-shadow: var(--shadow-lg);
  transform-style: preserve-3d;
}

.flip-card-front {
  background: linear-gradient(135deg, var(--primary), var(--primary-hover));
  color: white;
  font-size: 3rem;
  z-index: 2; /* 确保正面在最上 */
  transform: rotateY(0deg);
}

.flip-card-back {
  background: var(--bg-card);
  color: var(--primary);
  transform: rotateY(180deg); /* 初始背面旋转 180 度 */
  border: 2px solid var(--primary);
  z-index: 1;
}

